<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Trainer Panel Surya Realistis</title>
<style>
  body {
    margin:0;
    font-family: Arial, sans-serif;
    background:#87ceeb;
    transition: background 1s;
  }
  #sky {
    position:relative;
    width:100%;
    height:300px;
    overflow:hidden;
  }
  #sun {
    position:absolute;
    width:80px;
    height:80px;
    border-radius:50%;
    background:yellow;
    top:100px;
    left:0;
    transition: all 2s linear;
  }
  #clouds {
    position:absolute;
    top:20px;
    left:0;
    width:100%;
    height:100px;
    pointer-events:none;
    overflow:hidden;
  }
  .cloud {
    position:absolute;
    width:120px;
    height:60px;
    background:#fff;
    border-radius:60px;
    opacity:0.8;
    animation: cloudMove 60s linear infinite;
  }
  @keyframes cloudMove {
    from {left:-200px;}
    to {left:100%;}
  }
  #rain {
    position:absolute;
    width:100%;
    height:100%;
    top:0;
    left:0;
    pointer-events:none;
    display:none;
  }
  .drop {
    position:absolute;
    width:2px;
    height:10px;
    background:blue;
    animation: dropFall 1s linear infinite;
  }
  @keyframes dropFall {
    from {top:-10px;}
    to {top:300px;}
  }
  #controls, #data, #notes {
    padding:15px;
    background:#fff;
    margin:10px;
    border-radius:10px;
    box-shadow:0 0 10px rgba(0,0,0,0.2);
  }
  button {
    margin:5px;
    padding:10px;
    border:none;
    border-radius:8px;
    cursor:pointer;
    background:#007bff;
    color:white;
  }
  button:hover {
    background:#0056b3;
  }
  h2 {
    margin-top:0;
  }
</style>
</head>
<body>

<div id="sky">
  <div id="sun"></div>
  <div id="clouds"></div>
  <div id="rain"></div>
</div>

<div id="controls">
  <h2>Kontrol</h2>
  <button onclick="sambungBaterai()">Sambungkan Baterai</button>
  <button onclick="sambungInverter()">Sambungkan Inverter</button>
  <button onclick="tesBeban()">Tes Beban</button>
  <button onclick="toggleAuto()">Otomatis Panel</button>
</div>

<div id="data">
  <h2>Data Sistem</h2>
  <p>Voltage Panel: <span id="vPanel">0</span> V</p>
  <p>Voltage Baterai: <span id="vBatt">12</span> V</p>
  <p>Arus Beban: <span id="amp">0</span> A</p>
  <p>Sisa Baterai: <span id="battPerc">100</span>%</p>
  <p>Cuaca: <span id="weather">Cerah</span></p>
  <p>Waktu: <span id="timeOfDay">Pagi</span></p>
</div>

<div id="notes">
  <h2>Catatan Pembelajaran</h2>
  <ul>
    <li>Panel surya menghasilkan listrik tergantung intensitas cahaya matahari dan kondisi cuaca.</li>
    <li>Baterai menyimpan energi dari panel untuk digunakan saat matahari redup atau malam hari.</li>
    <li>Inverter diperlukan untuk mengubah arus DC menjadi AC agar bisa dipakai perangkat rumah tangga.</li>
    <li>Beban akan menguras baterai, terutama saat cuaca buruk produksi panel berkurang.</li>
    <li>Mode otomatis membuat panel mengikuti posisi matahari untuk efisiensi maksimal.</li>
  </ul>
</div>

<script>
let vBatt = 12;
let battPerc = 100;
let vPanel = 0;
let ampLoad = 0;
let bateraiOn = false;
let inverterOn = false;
let autoOn = false;
let sun = document.getElementById("sun");
let timePhase = 0; // 0 pagi, 1 siang, 2 sore, 3 malam
let weather = "Cerah";

// Fungsi kontrol
function sambungBaterai(){ bateraiOn = true; alert("Baterai tersambung"); }
function sambungInverter(){ inverterOn = true; alert("Inverter tersambung"); }
function tesBeban(){
  if(!inverterOn){ alert("Gagal! Inverter belum tersambung"); return; }
  ampLoad = Math.floor(Math.random()*5)+1;
  battPerc -= ampLoad*2;
  if(battPerc<0) battPerc=0;
  updateData();
}

// Toggle panel otomatis
function toggleAuto(){
  autoOn = !autoOn;
  alert("Panel otomatis: "+(autoOn?"ON":"OFF"));
}

// Simulasi cuaca random
function randomWeather(){
  let rnd = Math.random();
  if(rnd<0.6) weather = "Cerah";
  else if(rnd<0.85) weather = "Mendung";
  else weather = "Hujan";
}

// Render cuaca
function renderWeather(){
  document.getElementById("weather").innerText = weather;
  let rain = document.getElementById("rain");
  let clouds = document.getElementById("clouds");
  clouds.innerHTML="";
  rain.innerHTML="";
  if(weather==="Mendung"||weather==="Hujan"){
    let c=document.createElement("div");
    c.className="cloud";
    clouds.appendChild(c);
  }
  if(weather==="Hujan"){
    rain.style.display="block";
    for(let i=0;i<50;i++){
      let d=document.createElement("div");
      d.className="drop";
      d.style.left=Math.random()*window.innerWidth+"px";
      d.style.animationDuration=(0.5+Math.random())+"s";
      rain.appendChild(d);
    }
  } else {
    rain.style.display="none";
  }
}

// Simulasi pergerakan matahari
function moveSun(){
  let sky=document.getElementById("sky");
  let phases=["Pagi","Siang","Sore","Malam"];
  document.getElementById("timeOfDay").innerText=phases[timePhase];
  
  if(timePhase===0){ // pagi
    sun.style.left="10%";
    sun.style.top="120px";
    vPanel=weather==="Cerah"?15:weather==="Mendung"?8:3;
  }else if(timePhase===1){ // siang
    sun.style.left="50%";
    sun.style.top="50px";
    vPanel=weather==="Cerah"?18:weather==="Mendung"?10:5;
  }else if(timePhase===2){ // sore
    sun.style.left="80%";
    sun.style.top="120px";
    vPanel=weather==="Cerah"?12:weather==="Mendung"?6:2;
  }else{ // malam
    sun.style.left="90%";
    sun.style.top="200px";
    vPanel=0;
  }

  if(bateraiOn){
    battPerc += vPanel*0.05; // charging
    if(ampLoad>0) battPerc -= ampLoad*0.5; // beban menguras
    if(weather==="Hujan") battPerc -= 0.2; // cuaca buruk mengurangi
    if(battPerc>100) battPerc=100;
    if(battPerc<0) battPerc=0;
  }
  updateData();
  timePhase=(timePhase+1)%4;
}

// Update data
function updateData(){
  document.getElementById("vPanel").innerText=vPanel.toFixed(1);
  document.getElementById("vBatt").innerText=vBatt.toFixed(1);
  document.getElementById("amp").innerText=ampLoad;
  document.getElementById("battPerc").innerText=battPerc.toFixed(1);
}

// Loop otomatis
setInterval(()=>{
  randomWeather();
  renderWeather();
  moveSun();
},5000);

updateData();
</script>

</body>
</html>
